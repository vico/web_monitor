{% extends "layout.html" %}
{% block body %}
<div class=metanav>
  {% if not session.logged_in %}
      <a href="{{ url_for('login') }}">log in</a>
  {% else %}
      <a href="{{ url_for('logout') }}">log out</a>
  {% endif %}
  </div>
<section class="sheet padding-10mm">

<table>
  <tr>
    <th>Analyst</th><td><strong>{{params['analyst']}}</strong></td><th>Start</th><td><strong>{{params['startDate']}}</strong></td>
  </tr>
  <tr>
    <td>Index</td><td>{{params['index']}}</td><th>End</th><td><strong>{{params['endDate']}}</strong></td>
  </tr>
</table>

<table>
  <tbody>
    <tr>
      <td></td>
      <td></td>
      <td>Total</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>Long Turnover</td>
      <td class="number">{{'{:,}'.format(params['longTurnover'])}}</td>
      <td class="number">{{'{:.1f}%'.format(params['totalLong'])}}</td>
      <td>Long PL</td>
      <td class="number">{{'{:,}'.format(params['longPL'])}}</td>
      <td>Long Topix O/P</td>
      <td class="number">{{'{:.2f}%'.format(params['longIndexOP'])}}</td>
      <td>Long Beta O/P</td>
      <td class="number">{{'{:.2f}%'.format(params['longBetaOP'])}}</td>
    </tr>
    <tr>
      <td>Short Turnover</td>
      <td class="number">{{'{:,}'.format(params['shortTurnover'])}}</td>
      <td class="number">{{'{:.1f}%'.format(params['totalShort'])}}</td>
      <td>Short PL</td>
      <td class="number">{{'{:,}'.format(params['shortPL'])}}</td>
      <td>Short Topix O/P</td>
      <td class="number">{{'{:.2f}%'.format(params['shortIndexOP'])}}</td>
      <td>Short Beta O/P</td>
      <td class="number">{{'{:.2f}%'.format(params['shortBetaOP'])}}</td>
    </tr>
  </tbody>
  <tfoot class="overlineTfoot">
    <tr>
      <td>Total Turnover</td>
      <td class="number">{{'{:,}'.format(params['longTurnover']+params['shortTurnover'])}}</td>
      <td class="number">{{'{:.1f}%'.format((params['totalLong']+params['totalShort'])/2)}}</td>
      <td>Total PL</td>
      <td class="number">{{'{:,}'.format(params['longPL']+params['shortPL'])}}</td>
      <td>Total Topix O/P</td>
      <td class="number">{{'{:.2f}%'.format(params['longIndexOP']+params['shortIndexOP'])}}</td>
      <td>Total Beta O/P</td>
      <td class="number">{{'{:.2f}%'.format(params['longBetaOP']+params['shortBetaOP'])}}</td>
    </tr>
  </tfoot>
</table>
<table class="inlineTable col-1-3">
  <thead class="underlineTh">
    <tr>
      <td><strong>Exposure</strong></td>
      <td><strong>AUM</strong></td>
      <td><strong>Rank</strong></td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Average Long</td>
      <td class="number">7.5%</td>
      <td class="number">4</td>
    </tr>
    <tr>
      <td>Average Short</td>
      <td class="number">7.9%</td>
      <td class="number">5</td>
    </tr>
  </tbody>
</table>
<table class="inlineTable col-2-3">
  <tbody>
    <tr>
      <td>Long Return</td>
      <td class="number">{{'{:.1f}%'.format(params['longReturn'])}}</td>
    </tr>
    <tr>
      <td>Short Return</td>
      <td class="number">{{'{:.1f}%'.format(params['shortReturn'])}}</td>
    </tr>
  </tbody>
</table>
<div class="group">
<table class="inlineTable col-1-3">
  <caption>Hit Rate</caption>
  <tbody>
    <tr>   <td>Long</td>     <td class="number">{{'{:.2f}%'.format(params['longHitRate'])}}</td>     </tr>
    <tr>   <td>Short</td>    <td class="number">{{'{:.2f}%'.format(params['shortHitRate'])}}</td>     </tr>
</tbody>
<tfoot class="overlineTfoot">
  <tr>    <td>Total</td>   <td class="number">{{'{:.2f}%'.format((params['longHitRate']+params['shortHitRate'])/2)}}</td>  </tr>
</tfoot><!--
--></table>
<table class="inlineTable borderTable col-2-3">
  <caption>Total Fund PL in Bps</caption>
  <thead>
    <tr> <th>Fund</th>  <th>Long</th>  <th>Short</th>  <th>Grand Total</th> </tr>
  </thead>
  <tbody>
    <tr> <td>Rockhampton</td>  <td class="number">0.37%</td>  <td class="number">0.32%</td> <td class="number">0.72%</td>  </tr>
    <tr> <td>Yaraka</td>  <td class="number">0.37%</td>  <td class="number">0.32%</td> <td class="number">0.72%</td>  </tr>
    <tr> <td>LongReach</td> <td class="number">0.37%</td>  <td class="number">0.32%</td> <td class="number">0.72%</td>  </tr>
  </tbody>
</table>
</div>
<div id="plGraph" style="width:750px;height:400;"></div>

<script>
  TESTER = document.getElementById('plGraph');
  Plotly.plot( TESTER, [
    {% for col in csAttrDf['columns'] %}
      {
        x: {{csAttrDf.index | safe}},
        y: {{csAttrDf['columns'][col] | safe }},
        name: '{{col + ' PL' }}',
        line: { width: 3 }
      },
    {% endfor %}
  ], {
  margin: { t: 0 } } );
</script>
  {{params['test']}}
</section>
{% endblock %}
